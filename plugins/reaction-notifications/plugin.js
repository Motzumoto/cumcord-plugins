(function(f,s,R,F,t,n){"use strict";var O=()=>cumcord.patcher.injectCSS(".reaction-notifications-body{display:grid;grid-gap:12px;padding:8px 20px;align-items:center;border-radius:0;grid-template-columns:32px auto 40px}.reaction-notifications-username{flex-grow:1;cursor:pointer;font-weight:500;text-overflow:ellipsis;color:var(--text-normal)}.reaction-notifications-container{position:relative;background-color:var(--background-primary)}.reaction-notifications-message{padding:16px 16px 4px 0}.reaction-notifications-username:hover{text-decoration:underline}.reaction-notifications-first-message{border-radius:8px 8px 0 0}.reaction-notifications-last-reaction{border-radius:0 0 8px 8px}");/**
* NOTICE OF LICENSE
*
* This source file is subject to the GNU General Public License (GPL-3.0).
* You can find more information in the LICENSE.md file.
* More information is also avaliable at this URL:
* https://opensource.org/licenses/GPL-3.0
*
*
* @copyright Copyright (c) 2022 Paige Jordan
* @license   GPL-3.0 GNU General Public License v3.0
* @link      https://github.com/swishs-client-mod-plugins/cumcord-plugins/tree/main/plugins/reaction-notifications
*/n.findByProps("colorStatusRed"),n.findByDisplayName("Text");const L=n.findByDisplayName("Slider");n.findByDisplayName("Divider"),n.findByDisplayName("FormText");const _=n.findByDisplayName("Speaker"),H=n.findByDisplayName("TextInput"),h=n.findByDisplayName("FormTitle"),y=n.findByDisplayName("SwitchItem"),m=n.findByProps("soundRow");var G=()=>{f.useNest(s.persist);const e={inbox:!0,createSound:!0,volume:1,mentionSound:!0,link:""};for(let r in e)s.persist.ghost.hasOwnProperty(r)||(s.persist.store[r]=e[r]);return t.React.createElement(t.React.Fragment,null,t.React.createElement(h,null,"INBOX"),t.React.createElement(y,{onChange:()=>s.persist.store.inbox=!s.persist.ghost.inbox,value:s.persist.ghost.inbox},"Enable Recent Reactions in Inbox"),t.React.createElement(h,null,"NOTIFICATIONS"),t.React.createElement(y,{onChange:()=>s.persist.store.disableNotifications=!s.persist.ghost.disableNotifications,value:s.persist.ghost.disableNotifications,hideBorder:!0},"Disable Notifications"),t.React.createElement(y,{onChange:()=>s.persist.store.sendInDND=!s.persist.ghost.sendInDND,value:s.persist.ghost.sendInDND,disabled:s.persist.ghost.disableNotifications},"Send Notifications while in DND Mode"),t.React.createElement(h,{className:`${m.notificationSound} ${m.soundRow}`},"AUDIO",t.React.createElement("div",{className:m.soundIcon,onClick:()=>{if(!s.persist.ghost.createSound)return;const r="https://discord.com/assets/dd920c06a01e5bb8b09678581e29d56f.mp3",i=new Audio(s.persist.ghost.mentionSound?r:s.persist.ghost.link);i.volume=s.persist.ghost.volume,i.play()}},t.React.createElement(_,{width:15,height:24}))),t.React.createElement(y,{note:'Psst! You can preview the sound by hovering over "Audio" and clicking on the speaker!',onChange:()=>s.persist.store.createSound=!s.persist.ghost.createSound,value:s.persist.ghost.createSound,hideBorder:!0},"Create Sound on Notification"),t.React.createElement(y,{onChange:()=>s.persist.store.mentionSound=!s.persist.ghost.mentionSound,value:s.persist.ghost.mentionSound,disabled:!s.persist.ghost.createSound,hideBorder:!0},"Use Default Mention Sound"),t.React.createElement(h,null,"AUDIO LINK"),t.React.createElement(H,{size:"default",className:"codeRedemptionInput-fKM0fu",onChange:r=>s.persist.store.link=r,disabled:s.persist.ghost.mentionSound||!s.persist.ghost.createSound,value:s.persist.ghost.link}),t.React.createElement("div",{style:{paddingBottom:"20px"}}),t.React.createElement(h,null,"VOLUME (DEFAULT IS 100%)"),t.React.createElement(L,{initialValue:s.persist.ghost.volume*100,minValue:0,maxValue:100,disabled:!s.persist.ghost.createSound,onValueChange:r=>s.persist.store.volume=r/100}),t.React.createElement("div",{style:{paddingBottom:"20px"}}))};const v=[];var u={patch:e=>e&&v.push(e),unpatchAll:()=>v.forEach(e=>e())};/**
* NOTICE OF LICENSE
*
* This source file is subject to the GNU General Public License (GPL-3.0).
* You can find more information in the LICENSE.md file.
* More information is also avaliable at this URL:
* https://opensource.org/licenses/GPL-3.0
*
*
* @copyright Copyright (c) 2022 Paige Jordan
* @license   GPL-3.0 GNU General Public License v3.0
* @link      https://github.com/swishs-client-mod-plugins/cumcord-plugins/tree/main/plugins/reaction-notifications
*/const x=n.findByDisplayName("Text"),V=n.findByDisplayName("Reactions"),Z=n.findByDisplayNameAll("Header")[1],p=n.find(e=>e.prototype?.getGuildId),K=n.findByDisplayName("Checkmark"),I=n.findByDisplayName("FormDivider"),M=n.findByProps("AnimatedAvatar").default,J=n.findByDisplayName("CircleIconButton"),E=n.findByProps("MenuGroup","MenuItem"),X=n.findByDisplayNameAll("EmojiSmile")[1],Y=n.findByDisplayName("InboxEmptyStateStars"),A=n.find(e=>e.prototype?.toDate&&e.prototype.month),q=n.findByDisplayName("RecentsChannelHeader"),S=n.find(e=>e.type?.displayName==="ChannelMessage"),T=n.find(e=>e.prototype?.getReaction&&e.prototype.isSystemDM),{transitionTo:P}=n.findByProps("transitionTo"),{openUserProfileModal:b}=n.findByProps("openUserProfileModal"),{openContextMenu:Q,closeContextMenu:W}=n.findByProps("openContextMenu"),c={Sizes:n.findByProps("size10"),Button:n.findByProps("size32"),Stars:n.findByProps("stars","protip"),Colors:n.findByProps("colorStatusGreen")},D=()=>t.React.createElement("div",{className:"reaction-notifications-container",style:{borderRadius:"8px",marginTop:"8px",marginLeft:"16px"}},t.React.createElement(S,{channel:new p({id:"uwu"}),message:new T({content:"rape",timestamp:new A("2021-09-24T22:20:42.723Z"),author:{id:"192760945766957066",username:"creatable",toString:()=>"creatable",isSystemUser:()=>!1,getAvatarURL:()=>"https://cdn.discordapp.com/avatars/192760945766957066/629d2de47aab4d95fe45d846abfb083a.webp?size=80"}}),style:{paddingTop:"8px",marginLeft:"4px",textAlign:"left",marginRight:"132px"}}),t.React.createElement(S,{channel:new p({id:"uwu"}),message:new T({content:"LMAO",timestamp:new A("2021-09-24T22:20:42.723Z"),author:{id:"257109471589957632",username:"Beef",toString:()=>"Beef",isSystemUser:()=>!1,getAvatarURL:()=>"https://cdn.discordapp.com/avatars/257109471589957632/d1edbec71d56736a68bc639ed7da43d0.webp?size=80"}}),style:{marginLeft:"4px",textAlign:"left",paddingBottom:"8px"}})),w=()=>t.React.createElement("div",{className:c.Stars.container},t.React.createElement("div",{className:c.Stars.iconContainer},t.React.createElement(X,{className:c.Stars.icon,width:36,height:36}),t.React.createElement(Y,{className:c.Stars.stars})),t.React.createElement(Z,{className:c.Stars.header,size:c.Sizes.size24},"No reactions here!"),t.React.createElement(x,{className:c.Colors.colorHeaderSecondary,size:c.Sizes.size12},t.React.createElement(x,{tag:"span",className:c.Stars.protip,color:c.Colors.colorStatusGreen,size:c.Sizes.size12},"Protip:"," "),Math.random()<.1?t.React.createElement(D,null):"Cumming is always funner with friends!")),k=e=>t.React.createElement(q,{channel:e.channel,gotoChannel:()=>{P(`/channels/${e.channel.guildId||"@me"}/${e.channel.id}/${e.message}`)}},t.React.createElement(J,{className:`${c.Button.button} ${c.Button.tertiary}`,onClick:()=>delete s.persist.store.reactions[e.channel.id],tooltip:"Mark as Read",icon:t.React.createElement(K,{height:16,width:16})})),ee=e=>t.React.createElement(t.React.Fragment,null,e.isFirstMessage||t.React.createElement(I,null),t.React.createElement("div",{className:`reaction-notifications-message ${!e.isFirstMessage||"reaction-notifications-first-message"} reaction-notifications-container`},t.React.createElement(S,{message:e.message,channel:e.channel,onContextMenu:r=>Q(r,()=>t.React.createElement(t.React.Fragment,null,t.React.createElement(E.default,{onClose:W},t.React.createElement(E.MenuItem,{label:"Jump to Message",id:"jump",action:()=>{P(`/channels/${e.channel.guildId||"@me"}/${e.channel.id}/${e.message.id}`)}}),t.React.createElement(E.MenuItem,{label:"Delete Message",id:"delete",action:()=>{delete s.persist.store.reactions[e.channel.id][e.message.id]}}))))}))),te=e=>t.React.createElement(t.React.Fragment,null,t.React.createElement(I,null),t.React.createElement("div",{className:`reaction-notifications-body ${!e.isLastReaction||"reaction-notifications-last-reaction"} reaction-notifications-container`},t.React.createElement(M,{src:e.user.getAvatarURL(),size:M.Sizes.SIZE_32,onClick:()=>b({userId:e.user.id})}),t.React.createElement("div",{className:"reaction-notifications-username",onClick:()=>b({userId:e.user.id})},e.user.username,"#",e.user.discriminator),t.React.createElement("div",{className:"reaction-notifications-reactions"},t.React.createElement(V,{channel:new p({id:"uwu"}),message:{getChannelId:()=>"uwu!",reactions:[{count:e.count,emoji:e.reaction.emoji,me:!1}]},disableReactionCreates:!0,disableReactionUpdates:!0}))));/**
* NOTICE OF LICENSE
*
* This source file is subject to the GNU General Public License (GPL-3.0).
* You can find more information in the LICENSE.md file.
* More information is also avaliable at this URL:
* https://opensource.org/licenses/GPL-3.0
*
*
* @copyright Copyright (c) 2022 Paige Jordan
* @license   GPL-3.0 GNU General Public License v3.0
* @link      https://github.com/swishs-client-mod-plugins/cumcord-plugins/tree/main/plugins/reaction-notifications
*/const{getGuild:se}=n.findByProps("getGuild"),{getChannel:ne}=n.findByProps("getDMUserIds"),{transitionTo:ie}=n.findByProps("transitionTo"),{showNotification:re}=n.findByProps("showNotification"),{getStatus:ae}=n.findByProps("getStatus","getPresence"),{getMessage:oe}=n.findByProps("getMessage","getMessages"),{AdvancedScrollerThin:ce}=n.findByProps("AdvancedScrollerThin"),{getUser:de,getCurrentUser:le}=n.findByProps("getUser","getCurrentUser"),ue=n.findByProps("Header","Item"),N=n.findByProps("getFullState","settings"),U=n.find(e=>e.default?.displayName==="RecentsHeader"),fe=n.find(e=>e.default?.displayName==="RecentMentions"),he=n.find(e=>e.default?.displayName==="UnreadMessages"),B={...n.findByProps("tab","header"),...n.findByProps("messageContainer")},$=e=>{if(s.persist.ghost.disableNotifications)return;const r=le().id;if(e?.userId!==r){const i=oe(e.channelId,e.messageId);if(i?.author.id===r){const o=de(e.userId),a=ne(e.channelId),d=se(a.guild_id);if(s.persist.ghost.reactions[a.id]||(s.persist.store.reactions[a.id]={channel:a}),s.persist.ghost.reactions[a.id][i.id]||(s.persist.store.reactions[a.id][i.id]=[i]),s.persist.store.reactions[a.id][i.id].push({reaction:e,guild:d,user:o,message:i,channel:a,count:i.reactions.find(l=>l.emoji.name===e.emoji.name&&l.emoji.id===e.emoji.id).count}),(s.persist.ghost.sendInDND||ae(r)!=="dnd")&&(re(o.getAvatarURL(),`${o.username}${d?` (#${a.name}, ${d.name})`:""}`,`New Reaction: ${e.emoji.name}`,{onClick:()=>ie(path)}),s.persist.ghost.createSound)){const l="https://discord.com/assets/dd920c06a01e5bb8b09678581e29d56f.mp3",g=new Audio(s.persist.ghost.mentionSound?l:s.persist.ghost.link);g.volume=s.persist.ghost.volume,g.play()}}}},j=()=>{const e=s.persist.ghost.reactions,r=[[]];return f.useNest(s.persist),Object.keys(e).forEach((i,o)=>{if(r[o]||r.push([]),Object.keys(e[i]).length===1){delete e[i];return}r[o].push(t.React.createElement(k,{channel:e[i].channel,message:e[i][Object.keys(e[i])[1]][0].id})),Object.keys(e[i]).forEach((a,d,l)=>{if(a==="channel")return;const g=d===1,me=d===l.length-1;r[o].push(t.React.createElement(ee,{isFirstMessage:g,message:e[i][a][0],channel:e[i].channel})),e[i][a].forEach((pe,z,C)=>{if(z===0)return;C.length===1&&delete e[i][a];const Ee=me&&(C.length===1||z===C.length-1);r[o].push(t.React.createElement(te,{...pe,isLastReaction:Ee}))})})}),t.React.createElement(F.ErrorBoundary,null,t.React.createElement(ce,{fade:!0},r[0].length?r.map(i=>t.React.createElement("div",{className:B.container},i)):t.React.createElement(w,null)))},ye=()=>{if(!s.persist.ghost.inbox)return;const e=({__originalType:r,...i})=>{const o=r.call(void 0,i);try{N.settings.inbox.currentTab===3&&(o.props.children[1]=t.React.createElement(j,null))}catch(a){console.error("RecentMentions patch failed:",a)}return o};u.patch(R.after("default",fe,(r,i)=>{Object.assign(i.props,{__originalType:i.type}),i.type=e})),u.patch(R.after("default",he,(r,i)=>{N.settings.inbox.currentTab===3&&(i.props.children[1]=t.React.createElement(j,null))}))},Re=()=>{if(!s.persist.ghost.inbox)return;const e=({__originalType:r,...i})=>{const o=r.call(void 0,i);if(i.tab!==3)return o;try{const a=f.findInReactTree(o,d=>typeof d?.onClick=="function");if(!a)return o;a.onClick=()=>s.persist.store.reactions={}}catch(a){console.error("ReadAllButton patch failed:",a)}return o};u.patch(R.before("default",U,([r])=>{r.tab=N.settings.inbox.currentTab})),u.patch(R.after("default",U,([r],i)=>{const o=f.findInReactTree(i,l=>l?.onItemSelect),a=f.findInReactTree(i,l=>typeof l?.props?.onClick=="function"),d=o?.children;!Array.isArray(d)||(a&&(Object.assign(a.props,{__originalType:a.type,tab:r.tab}),a.type=e),d.push(t.React.createElement(ue.Item,{id:3,look:0,className:`${B.tab}${r.tab===3?` ${B.active}`:""}`},"Reactions")))}))};var ge=()=>({onLoad(){s.persist.ghost.reactions||(s.persist.store.reactions={}),t.FluxDispatcher.subscribe("MESSAGE_REACTION_ADD",$),u.patch(O()),ye(),Re()},onUnload(){t.FluxDispatcher.unsubscribe("MESSAGE_REACTION_ADD",$),u.unpatchAll()},settings:t.React.createElement(G,null)});return ge})(cumcord.utils,cumcord.pluginData,cumcord.patcher,cumcord.ui.components,cumcord.modules.common,cumcord.modules.webpack);
