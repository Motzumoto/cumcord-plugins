(function(g,t,m,V,s,n){"use strict";var Z=()=>cumcord.patcher.injectCSS(".reaction-notifications-body{display:grid;grid-gap:12px;padding:8px 20px;align-items:center;border-radius:0;grid-template-columns:32px auto 40px}.reaction-notifications-username{flex-grow:1;cursor:pointer;font-weight:500;text-overflow:ellipsis;color:var(--text-normal)}.reaction-notifications-container{position:relative;background-color:var(--background-primary)}.reaction-notifications-message{padding:16px 16px 4px 0}.reaction-notifications-username:hover{text-decoration:underline}.reaction-notifications-first-message{border-radius:8px 8px 0 0}.reaction-notifications-last-reaction{border-radius:0 0 8px 8px}");/**
* NOTICE OF LICENSE
*
* This source file is subject to the GNU General Public License (GPL-3.0).
* You can find more information in the LICENSE.md file.
* More information is also avaliable at this URL:
* https://opensource.org/licenses/GPL-3.0
*
*
* @copyright Copyright (c) 2022 Paige Jordan
* @license   GPL-3.0 GNU General Public License v3.0
* @link      https://github.com/swishs-client-mod-plugins/cumcord-plugins/tree/main/plugins/reaction-notifications
*/n.findByDisplayName("Text");const q=n.findByDisplayName("Slider"),p=n.findByProps("DropdownSizes"),K=n.findByDisplayName("Divider");n.findByDisplayName("FormText");const W=n.findByDisplayName("Speaker"),J=n.findByDisplayName("TextInput"),u=n.findByDisplayName("FormTitle"),h=n.findByDisplayName("SwitchItem"),E=n.findByProps("soundRow");var X=()=>(g.useNest(t.persist),s.React.createElement(s.React.Fragment,null,s.React.createElement(u,null,"INBOX"),s.React.createElement(h,{onChange:()=>t.persist.store.disableInbox=!t.persist.ghost.disableInbox,value:t.persist.ghost.disableInbox,hideBorder:!0},"Disable recent reactions in inbox (requires reload)"),s.React.createElement(h,{note:"Add reactions to the inbox even if the reaction is from the current channel.",onChange:()=>t.persist.store.addFromCurrent=!t.persist.ghost.addFromCurrent,value:t.persist.ghost.addFromCurrent,disabled:t.persist.ghost.disableInbox},"Add to inbox from current channel"),s.React.createElement(u,null,"MESSAGE CACHING"),s.React.createElement(h,{note:"Will log every message ID sent from you so the plugin can manually request the message if it isn't cached.",onChange:()=>t.persist.store.enableMessageCache=!t.persist.ghost.enableMessageCache,value:t.persist.ghost.enableMessageCache,hideBorder:!0},"Enable Forced Message Cache"),s.React.createElement(p,{color:p.Colors.BRAND_NEW,size:p.Sizes.MEDIUM,onClick:()=>t.persist.store.messageStore={}},"Clear Message Cache (",Object.keys(t.persist.ghost.messageStore).reduce((e,i)=>e+=t.persist.ghost.messageStore[i].length,0),")"),s.React.createElement("div",{style:{paddingBottom:"20px"}}),s.React.createElement(K,null),s.React.createElement(u,null,"NOTIFICATIONS"),s.React.createElement(h,{onChange:()=>t.persist.store.disableNotifications=!t.persist.ghost.disableNotifications,value:t.persist.ghost.disableNotifications,hideBorder:!0},"Disable notifications"),s.React.createElement(h,{onChange:()=>t.persist.store.sendInDND=!t.persist.ghost.sendInDND,value:t.persist.ghost.sendInDND,disabled:t.persist.ghost.disableNotifications,hideBorder:!0},"Send notifications while in DND mode"),s.React.createElement(h,{note:"Send notifications even if the reaction is from the current channel.",onChange:()=>t.persist.store.sendInCurrent=!t.persist.ghost.sendInCurrent,value:t.persist.ghost.sendInCurrent,disabled:t.persist.ghost.disableNotifications},"Send notifications from the current channel"),s.React.createElement(u,{className:`${E.notificationSound} ${E.soundRow}`},"AUDIO",s.React.createElement("div",{className:E.soundIcon,onClick:()=>{if(!t.persist.ghost.createSound)return;const e="https://discord.com/assets/dd920c06a01e5bb8b09678581e29d56f.mp3",i=new Audio(t.persist.ghost.mentionSound?e:t.persist.ghost.link);i.volume=t.persist.ghost.volume,i.play()}},s.React.createElement(W,{width:15,height:24}))),s.React.createElement(h,{note:'Psst! You can preview the sound by hovering over "Audio" and clicking on the speaker!',onChange:()=>t.persist.store.createSound=!t.persist.ghost.createSound,value:t.persist.ghost.createSound,hideBorder:!0},"Create sound on notification"),s.React.createElement(h,{onChange:()=>t.persist.store.mentionSound=!t.persist.ghost.mentionSound,value:t.persist.ghost.mentionSound,disabled:!t.persist.ghost.createSound,hideBorder:!0},"Use default mention sound"),s.React.createElement(u,null,"AUDIO LINK"),s.React.createElement(J,{placeholder:"https://cdn.discordapp.com/attachments/829809799553482764/847584766148345866/society.mp3",className:"codeRedemptionInput-fKM0fu",onChange:e=>t.persist.store.link=e,disabled:t.persist.ghost.mentionSound||!t.persist.ghost.createSound,value:t.persist.ghost.link}),s.React.createElement("div",{style:{paddingBottom:"20px"}}),s.React.createElement(u,null,"VOLUME (DEFAULT IS 100%)"),s.React.createElement(q,{initialValue:t.persist.ghost.volume*100,minValue:0,maxValue:100,disabled:!t.persist.ghost.createSound,onValueChange:e=>t.persist.store.volume=e/100}),s.React.createElement("div",{style:{paddingBottom:"20px"}})));const M=[];var f={patch:e=>e&&M.push(e),unpatchAll:()=>M.forEach(e=>e())};/**
* NOTICE OF LICENSE
*
* This source file is subject to the GNU General Public License (GPL-3.0).
* You can find more information in the LICENSE.md file.
* More information is also avaliable at this URL:
* https://opensource.org/licenses/GPL-3.0
*
*
* @copyright Copyright (c) 2022 Paige Jordan
* @license   GPL-3.0 GNU General Public License v3.0
* @link      https://github.com/swishs-client-mod-plugins/cumcord-plugins/tree/main/plugins/reaction-notifications
*/const x=n.findByDisplayName("Text"),Y=n.findByDisplayName("Reactions"),Q=n.findByDisplayNameAll("Header")[1],S=n.find(e=>e.prototype?.getGuildId),w=n.findByDisplayName("Checkmark"),b=n.findByDisplayName("FormDivider"),A=n.findByProps("AnimatedAvatar").default,k=n.findByDisplayName("CircleIconButton"),C=n.findByProps("MenuGroup","MenuItem"),D=n.findByDisplayNameAll("EmojiSmile")[1],ee=n.findByDisplayName("InboxEmptyStateStars"),T=n.find(e=>e.prototype?.toDate&&e.prototype.month),te=n.findByDisplayName("RecentsChannelHeader"),I=n.find(e=>e.type?.displayName==="ChannelMessage"),P=n.find(e=>e.prototype?.getReaction&&e.prototype.isSystemDM),{transitionTo:F}=n.findByProps("transitionTo"),{openUserProfileModal:U}=n.findByProps("openUserProfileModal"),{openContextMenu:se,closeContextMenu:ne}=n.findByProps("openContextMenu"),c={Sizes:n.findByProps("size10"),Button:n.findByProps("size32"),Stars:n.findByProps("stars","protip"),Colors:n.findByProps("colorStatusGreen")},$=()=>s.React.createElement("div",{className:"reaction-notifications-container",style:{borderRadius:"8px",marginTop:"8px",marginLeft:"16px"}},s.React.createElement(I,{channel:new S({id:"uwu"}),message:new P({content:"rape",timestamp:new T("2021-09-24T22:20:42.723Z"),author:{id:"192760945766957066",username:"creatable",toString:()=>"creatable",isSystemUser:()=>!1,getAvatarURL:()=>"https://cdn.discordapp.com/avatars/192760945766957066/629d2de47aab4d95fe45d846abfb083a.webp?size=80"}}),style:{paddingTop:"8px",marginLeft:"4px",textAlign:"left",marginRight:"132px"}}),s.React.createElement(I,{channel:new S({id:"uwu"}),message:new P({content:"LMAO",timestamp:new T("2021-09-24T22:20:42.723Z"),author:{id:"257109471589957632",username:"Beef",toString:()=>"Beef",isSystemUser:()=>!1,getAvatarURL:()=>"https://cdn.discordapp.com/avatars/257109471589957632/d1edbec71d56736a68bc639ed7da43d0.webp?size=80"}}),style:{marginLeft:"4px",textAlign:"left",paddingBottom:"8px"}}));var R={RapeLMAO:$,NoReactions:()=>s.React.createElement("div",{className:c.Stars.container},s.React.createElement("div",{className:c.Stars.iconContainer},s.React.createElement(D,{className:c.Stars.icon,width:36,height:36}),s.React.createElement(ee,{className:c.Stars.stars})),s.React.createElement(Q,{className:c.Stars.header,size:c.Sizes.size24},"No reactions here!"),s.React.createElement(x,{className:c.Colors.colorHeaderSecondary,size:c.Sizes.size12},s.React.createElement(x,{tag:"span",className:c.Stars.protip,color:c.Colors.colorStatusGreen,size:c.Sizes.size12},"Protip:"," "),Math.random()<.1?s.React.createElement($,null):"Cumming is always funner with friends!")),ReactionCardHeader:e=>s.React.createElement(te,{channel:e.channel,gotoChannel:()=>{F(`/channels/${e.channel.guildId||"@me"}/${e.channel.id}/${e.message}`)}},s.React.createElement(k,{className:`${c.Button.button} ${c.Button.tertiary}`,onClick:()=>delete t.persist.store.reactions[e.channel.id],tooltip:"Mark as Read",icon:s.React.createElement(w,{height:16,width:16})})),RenderMessage:e=>s.React.createElement(s.React.Fragment,null,e.isFirstMessage||s.React.createElement(b,null),s.React.createElement("div",{className:`reaction-notifications-message ${!e.isFirstMessage||"reaction-notifications-first-message"} reaction-notifications-container`},s.React.createElement(I,{message:e.message,channel:e.channel,onContextMenu:i=>se(i,()=>s.React.createElement(s.React.Fragment,null,s.React.createElement(C.default,{onClose:ne},s.React.createElement(C.MenuItem,{label:"Jump to Message",id:"jump",action:()=>{F(`/channels/${e.channel.guildId||"@me"}/${e.channel.id}/${e.message.id}`)}}),s.React.createElement(C.MenuItem,{label:"Delete Message",id:"delete",action:()=>{delete t.persist.store.reactions[e.channel.id][e.message.id]}}))))}))),ReactionCardBody:e=>s.React.createElement(s.React.Fragment,null,s.React.createElement(b,null),s.React.createElement("div",{className:`reaction-notifications-body ${!e.isLastReaction||"reaction-notifications-last-reaction"} reaction-notifications-container`},s.React.createElement(A,{src:e.user.getAvatarURL(),size:A.Sizes.SIZE_32,onClick:()=>U({userId:e.user.id})}),s.React.createElement("div",{className:"reaction-notifications-username",onClick:()=>U({userId:e.user.id})},e.user.username,"#",e.user.discriminator),s.React.createElement("div",{className:"reaction-notifications-reactions"},s.React.createElement(Y,{channel:new S({id:"uwu"}),message:{getChannelId:()=>"uwu!",reactions:[{count:e.count,emoji:e.reaction.emoji,me:!1}]},disableReactionCreates:!0,disableReactionUpdates:!0}))))};/**
* NOTICE OF LICENSE
*
* This source file is subject to the GNU General Public License (GPL-3.0).
* You can find more information in the LICENSE.md file.
* More information is also avaliable at this URL:
* https://opensource.org/licenses/GPL-3.0
*
*
* @copyright Copyright (c) 2022 Paige Jordan
* @license   GPL-3.0 GNU General Public License v3.0
* @link      https://github.com/swishs-client-mod-plugins/cumcord-plugins/tree/main/plugins/reaction-notifications
*/const{getGuild:re}=n.findByProps("getGuild"),{getChannel:ie}=n.findByProps("getDMUserIds"),{fetchMessages:ae}=n.findByProps("sendMessage"),{transitionTo:oe}=n.findByProps("transitionTo"),{getChannelId:j}=n.findByProps("getVoiceChannelId"),{showNotification:ce}=n.findByProps("showNotification"),{getStatus:de}=n.findByProps("getStatus","getPresence"),{getMessage:z}=n.findByProps("getMessage","getMessages"),{AdvancedScrollerThin:le}=n.findByProps("AdvancedScrollerThin"),{getUser:he,getCurrentUser:ue}=n.findByProps("getUser","getCurrentUser"),fe=n.findByProps("Header","Item"),B=n.findByProps("getFullState","settings"),O=n.find(e=>e.default?.displayName==="RecentsHeader"),ge=n.find(e=>e.default?.displayName==="RecentMentions"),me=n.find(e=>e.default?.displayName==="UnreadMessages"),N={...n.findByProps("tab","header"),...n.findByProps("messageContainer")},Re=(e,i)=>({channelId:e,jump:{flash:!0,messageId:i},limit:1}),_=async e=>{const i=ue().id;if(e?.userId!==i){let r=z(e.channelId,e.messageId);if(!r&&t.persist.ghost.enableMessageCache&&t.persist.ghost.messageStore[e.channelId]?.includes(e.messageId)&&(await ae(Re(e.channelId,e.messageId)),await new Promise(o=>setTimeout(o,300)),r=z(e.channelId,e.messageId)),r?.author.id===i){const o=he(e.userId),a=ie(e.channelId),d=re(a.guild_id);if((t.persist.ghost.addFromCurrent||j()!==a.id)&&(t.persist.ghost.disableInbox||(t.persist.ghost.reactions[a.id]||(t.persist.store.reactions[a.id]={channel:a}),t.persist.ghost.reactions[a.id][r.id]||(t.persist.store.reactions[a.id][r.id]=[r]),t.persist.store.reactions[a.id][r.id].push({reaction:e,guild:d,user:o,message:r,channel:a,count:r.reactions.find(l=>l.emoji.name===e.emoji.name&&l.emoji.id===e.emoji.id).count}))),t.persist.ghost.disableNotifications)return;if((t.persist.ghost.sendInCurrent||j()!==a.id)&&(t.persist.ghost.sendInDND||de(i)!=="dnd")&&(ce(o.getAvatarURL(),`${o.username}${d?` (#${a.name}, ${d.name})`:""}`,`New Reaction: ${e.emoji.name}`,{onClick:()=>oe(path)}),t.persist.ghost.createSound)){const l="https://discord.com/assets/dd920c06a01e5bb8b09678581e29d56f.mp3",y=new Audio(t.persist.ghost.mentionSound?l:t.persist.ghost.link);y.volume=t.persist.ghost.volume,y.play()}}}},L=e=>{!t.persist.ghost.enableMessageCache||!e.sendMessageOptions||e.optimistic||(t.persist.ghost.messageStore[e.channelId]||(t.persist.store.messageStore[e.channelId]=[]),t.persist.store.messageStore[e.channelId].push(e.message.id))},H=()=>{const e=t.persist.ghost.reactions,i=[[]];return g.useNest(t.persist),Object.keys(e).forEach((r,o)=>{if(i[o]||i.push([]),Object.keys(e[r]).length===1){delete e[r];return}i[o].push(s.React.createElement(R.ReactionCardHeader,{channel:e[r].channel,message:e[r][Object.keys(e[r])[1]][0].id})),Object.keys(e[r]).forEach((a,d,l)=>{if(a==="channel")return;const y=d===1,Se=d===l.length-1;i[o].push(s.React.createElement(R.RenderMessage,{isFirstMessage:y,message:e[r][a][0],channel:e[r].channel})),e[r][a].forEach((Ce,G,v)=>{if(G===0)return;v.length===1&&delete e[r][a];const Ie=Se&&(v.length===1||G===v.length-1);i[o].push(s.React.createElement(R.ReactionCardBody,{...Ce,isLastReaction:Ie}))})})}),s.React.createElement(V.ErrorBoundary,null,s.React.createElement(le,{fade:!0},i[0].length?i.map(r=>s.React.createElement("div",{className:N.container},r)):s.React.createElement(R.NoReactions,null)))},ye=()=>{const e=({__originalType:i,...r})=>{const o=i.call(void 0,r);try{B.settings.inbox.currentTab===3&&(o.props.children[1]=s.React.createElement(H,null))}catch(a){console.error("RecentMentions patch failed:",a)}return o};f.patch(m.after("default",ge,(i,r)=>{Object.assign(r.props,{__originalType:r.type}),r.type=e})),f.patch(m.after("default",me,(i,r)=>{B.settings.inbox.currentTab===3&&(r.props.children[1]=s.React.createElement(H,null))}))},pe=()=>{const e=({__originalType:i,...r})=>{const o=i.call(void 0,r);if(r.tab!==3)return o;try{const a=g.findInReactTree(o,d=>typeof d?.onClick=="function");if(!a)return o;a.onClick=()=>t.persist.store.reactions={}}catch(a){console.error("ReadAllButton patch failed:",a)}return o};f.patch(m.before("default",O,([i])=>{i.tab=B.settings.inbox.currentTab})),f.patch(m.after("default",O,([i],r)=>{const o=g.findInReactTree(r,l=>l?.onItemSelect),a=g.findInReactTree(r,l=>typeof l?.props?.onClick=="function"),d=o?.children;!Array.isArray(d)||(a&&(Object.assign(a.props,{__originalType:a.type,tab:i.tab}),a.type=e),d.push(s.React.createElement(fe.Item,{id:3,look:0,className:`${N.tab}${i.tab===3?` ${N.active}`:""}`},"Reactions")))}))};var Ee=()=>({onLoad(){t.persist.ghost.reactions||(t.persist.store.reactions={}),t.persist.ghost.messageStore||(t.persist.store.messageStore={});const e={link:"",volume:1,createSound:!0,mentionSound:!0,sendInCurrent:!0};for(let i in e)t.persist.ghost.hasOwnProperty(i)||(t.persist.store[i]=e[i]);s.FluxDispatcher.subscribe("MESSAGE_CREATE",L),s.FluxDispatcher.subscribe("MESSAGE_REACTION_ADD",_),t.persist.ghost.disableInbox||(f.patch(Z()),ye(),pe())},onUnload(){s.FluxDispatcher.unsubscribe("MESSAGE_CREATE",L),s.FluxDispatcher.unsubscribe("MESSAGE_REACTION_ADD",_),f.unpatchAll()},settings:s.React.createElement(X,null)});return Ee})(cumcord.utils,cumcord.pluginData,cumcord.patcher,cumcord.ui.components,cumcord.modules.common,cumcord.modules.webpack);
